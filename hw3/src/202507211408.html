<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>React Nutrition Table</title>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      color: #333;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .container {
      max-width: 1000px;
      width: 95%;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }
    
    header {
      background: #2c3e50;
      color: white;
      padding: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, #3498db, #2ecc71, #e74c3c, #f39c12);
    }
    
    h1 {
      font-size: 2.8rem;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 700px;
      margin: 0 auto;
    }
    
    .content {
      padding: 30px;
    }
    
    .flex-container {
      display: flex;
      gap: 30px;
      margin-top: 20px;
    }
    
    @media (max-width: 768px) {
      .flex-container {
        flex-direction: column;
      }
    }
    
    .nutrition-input {
      flex: 1;
      background: #f8f9fa;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .table-container {
      flex: 1;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    h2 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 1.8rem;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      display: flex;
      align-items: center;
    }
    
    h2 i {
      margin-right: 10px;
      color: #3498db;
    }
    
    .nutrient-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      margin-bottom: 10px;
      background: #ecf0f1;
      border-radius: 8px;
      transition: all 0.3s ease;
    }
    
    .nutrient-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      background: linear-gradient(90deg, #d6eaf8, #ecf0f1);
    }
    
    .nutrient-name {
      font-weight: 600;
      color: #2c3e50;
      text-transform: capitalize;
    }
    
    .nutrient-value {
      background: #3498db;
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: 600;
    }
    
    .table-wrapper {
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    
    th {
      background: #2c3e50;
      color: white;
      padding: 16px;
      text-align: left;
      font-weight: 600;
      position: relative;
    }
    
    th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 10%;
      right: 10%;
      height: 3px;
      background: #3498db;
    }
    
    td {
      padding: 14px 16px;
      border-bottom: 1px solid #eee;
    }
    
    tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    tr:hover {
      background-color: #e3f2fd;
    }
    
    .control-panel {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: #2c3e50;
      color: white;
      border-radius: 10px;
      margin-bottom: 25px;
    }
    
    .stats {
      display: flex;
      gap: 20px;
    }
    
    .stat-item {
      background: rgba(255, 255, 255, 0.15);
      padding: 12px 20px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 5px;
    }
    
    .stat-value {
      font-size: 1.4rem;
      font-weight: 700;
    }
    
    .toggle-switch {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #e74c3c;
      transition: .4s;
      border-radius: 34px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: #2ecc71;
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    
    .explanation {
      background: #e3f2fd;
      padding: 25px;
      border-radius: 10px;
      margin-top: 25px;
    }
    
    .code-block {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      overflow-x: auto;
      margin: 20px 0;
      font-size: 1rem;
      line-height: 1.5;
    }
    
    .highlight {
      color: #f39c12;
      font-weight: bold;
    }
    
    .key-points {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }
    
    .point-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      border-left: 4px solid #3498db;
    }
    
    .point-card h4 {
      color: #2c3e50;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }
    
    .point-card h4 i {
      margin-right: 10px;
      color: #3498db;
    }
    
    .point-card p {
      color: #555;
      font-size: 0.95rem;
    }
    
    footer {
      text-align: center;
      padding: 25px;
      background: #2c3e50;
      color: white;
      font-size: 1rem;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    
    .footer-content {
      max-width: 700px;
      margin: 0 auto;
    }
    
    .color-bar {
      height: 6px;
      background: linear-gradient(90deg, #3498db, #2ecc71, #e74c3c, #f39c12);
      border-radius: 3px;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;
    
    // 带单位的营养数据对象
    const initialNutrition = {
      calories: "120 kcal",
      protein: "5g",
      fat: "8g",
      carbohydrates: "4g"
    };
    
    // 格式化键名
    const formatKey = (key) => {
      return key.charAt(0).toUpperCase() + key.slice(1);
    };
    
    const NutritionTable = () => {
      // 控制表格是否显示
      const [showTable, setShowTable] = useState(true);
      
      // 营养数据
      const [nutrition, setNutrition] = useState(initialNutrition);
      
      // 更新营养数据
      const updateNutrient = (key, value) => {
        setNutrition(prev => ({
          ...prev,
          [key]: value
        }));
      };
      
      // 计算列数
      const columns = Object.keys(nutrition).length;
      
      // 计算总值（示例）
      const calculateTotal = () => {
        const values = Object.values(nutrition);
        let calories = 0;
        let protein = 0;
        
        values.forEach(val => {
          if (val.includes('kcal')) calories += parseInt(val);
          if (val.includes('g')) {
            if (val.includes('protein')) protein += parseInt(val);
          }
        });
        
        // 这是一个简化的示例，实际应用中需要更复杂的解析
        return {
          calories: calories || 0,
          protein: protein || 0
        };
      };
      
      const totals = calculateTotal();
      
      return (
        <div className="container">
          <header>
            <h1>React Nutrition Table Generator</h1>
            <p className="subtitle">基于 nutrition 对象动态生成表格列</p>
          </header>
          
          <div className="content">
            <div className="control-panel">
              <div className="stats">
                <div className="stat-item">
                  <div className="stat-label">列数</div>
                  <div className="stat-value">{columns}</div>
                </div>
                <div className="stat-item">
                  <div className="stat-label">热量</div>
                  <div className="stat-value">{totals.calories} kcal</div>
                </div>
                <div className="stat-item">
                  <div className="stat-label">蛋白质</div>
                  <div className="stat-value">{totals.protein}g</div>
                </div>
              </div>
              
              <div className="toggle-switch">
                <span>显示表格</span>
                <label className="switch">
                  <input 
                    type="checkbox" 
                    checked={showTable} 
                    onChange={() => setShowTable(!showTable)} 
                  />
                  <span className="slider"></span>
                </label>
              </div>
            </div>
            
            <div className="flex-container">
              <div className="nutrition-input">
                <h2><i className="icon">📊</i> Nutrition 数据结构</h2>
                
                <div className="nutrients-list">
                  {Object.entries(nutrition).map(([key, value]) => (
                    <div className="nutrient-item" key={key}>
                      <span className="nutrient-name">{formatKey(key)}</span>
                      <span className="nutrient-value">{value}</span>
                    </div>
                  ))}
                </div>
                
                <div className="code-block">
                  {`const nutrition = {\n`}
                  {Object.entries(nutrition).map(([key, value]) => (
                    `  ${key}: "${value}",\n`
                  ))}
                  {`}`}
                </div>
                
                <p>这是一个 JavaScript 对象，其中键表示营养名称，值表示营养含量。</p>
              </div>
              
              <div className="table-container">
                <h2><i className="icon">🧪</i> 动态生成的表格</h2>
                
                {showTable ? (
                  <div className="table-wrapper">
                    <table>
                      <thead>
                        <tr>
                          {/* 正确写法：使用 Object.keys(nutrition).map 生成表头 */}
                          {Object.keys(nutrition).map(key => (
                            <th key={key}>{formatKey(key)}</th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          {/* 生成表格单元格 */}
                          {Object.values(nutrition).map((value, index) => (
                            <td key={index}>{value}</td>
                          ))}
                        </tr>
                        <tr>
                          {Object.keys(nutrition).map(key => (
                            <td key={`daily-${key}`}>
                              {Math.round(Math.random() * 100)}% DV
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                ) : (
                  <div style={{
                    background: '#f8f9fa',
                    padding: '40px 20px',
                    borderRadius: '10px',
                    textAlign: 'center',
                    color: '#7f8c8d',
                    border: '2px dashed #ddd'
                  }}>
                    <h3>表格当前已隐藏</h3>
                    <p>切换上方开关显示动态生成的表格</p>
                  </div>
                )}
                
                <div className="explanation">
                  <h3>关键实现解释：</h3>
                  
                  <div className="code-block">
                    {/* 显示错误写法 */}
                    <span style={{color: '#e74c3c'}}>
                      {'// 错误写法：nutrition.keys() 不存在\n'}
                      {'nutrition.keys().map(n => {\n'}
                      {'  <th>{nutrition.n}</th>\n'}
                      {'})'}\n\n
                    </span>
                    
                    {/* 显示正确写法 */}
                    <span style={{color: '#2ecc71'}}>
                      {'// 正确写法：使用 Object.keys()\n'}
                      {'Object.keys(nutrition).map(key => (\n'}
                      {'  <th key={key}>{key}</th>\n'}
                      {')'}\n\n
                    </span>
                    
                    {'{showTable && (\n'}
                    {'  <table>\n'}
                    {'    <thead>\n'}
                    {'      <tr>\n'}
                    {'        {Object.keys(nutrition).map(key => (\n'}
                    {'          <th key={key}>{key}</th>\n'}
                    {'        )}\n'}
                    {'      </tr>\n'}
                    {'    </thead>\n'}
                    {'    ...\n'}
                    {'  </table>\n'}
                    {')}'}
                  </div>
                  
                  <p>上述代码中，我们使用<code className="highlight">Object.keys(nutrition)</code>获取对象所有键的数组，然后使用<code className="highlight">map()</code>方法遍历这些键并为每个键创建表头单元格。</p>
                  
                  <div className="key-points">
                    <div className="point-card">
                      <h4><i>✓</i> 为什么使用 Object.keys()？</h4>
                      <p>JavaScript 对象没有内建的 keys() 方法。要获取对象的键列表，必须使用 Object.keys(obj)。</p>
                    </div>
                    
                    <div className="point-card">
                      <h4><i>✓</i> 为什么需要 key 属性？</h4>
                      <p>React 要求每个动态生成的元素都有唯一的 key 属性，这有助于 React 高效地更新和重新渲染列表。</p>
                    </div>
                    
                    <div className="point-card">
                      <h4><i>✓</i> 为什么不能用 nutrition.n？</h4>
                      <p>在 map 函数中，n 是键名字符串，而不是 nutrition 对象的属性。访问属性值应使用 nutrition[n]。但表头应显示键名而非值。</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <footer>
            <div className="footer-content">
              <p>React 动态表格生成示例 | 通过 Object.keys() 获取对象属性</p>
              <p>使用 map() 方法将对象键转换为表头列</p>
              <div className="color-bar"></div>
            </div>
          </footer>
        </div>
      );
